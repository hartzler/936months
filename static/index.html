<html>
<head>
<style>
</style>
<script src="jquery.js"></script>
<script>

var months = ['J','F','M','A','M','J','J','A','S','O','N','D'];
var size=0;
var chart = [];
var mpl = 36;

function round(num, dec) {
	var result = Math.round(num*Math.pow(10,dec))/Math.pow(10,dec);
	return result;
}

function init() {
  draw_chart();
}

function draw_chart() {
  var thisyear = (new Date()).getFullYear();
  var thismonth = (new Date()).getMonth()+1;
  var year = parseInt($('#birthdate').val().substring(0,4));
  var month = parseInt($('#birthdate').val().substring(4,6),10);
 
  var now = (thisyear - year)*12 + (thismonth-month);

  var years = parseInt($('#expect').val());
  var size = years * 12;
  var table = '<table><tbody>';

  table += '<tr><th colspan="1">Age</th><th></th>'; 
  for(var i=0;i<mpl;i++)
    table += '<th style="width:1em;">' + months[(month-1+i)%12] + '</th>';
  table += '<th></th><th>Age</th></tr>'; 

  for(i=0;i<size;i++) {
    if(i%mpl==0)
      table += '<tr><th>' + (i/12) + '</th><th>' + (year+(i/12)) + '</th>';
    
    p= (i == now) ? 'X' : '.';

    table += '<td align="center">' + p + '</td>';
    if((i+1)%mpl==0)
      table += '<th>' + (year+((i+1)/12)) + '</th><th>' + Math.floor(i/12) + '</tr>';
  }

  table += '<tr><th colspan="2"></th>'; 
  for(var i=0;i<mpl;i++)
    table += '<th>' + months[(month-1+i)%12] + '</th>';
  table += '</tr>'; 
  table += '</tbody></table>';

  // "\n%d months: %d (%.0f%%) lived: %d (%.0f%%) to go!" % [years*12, spent,spent.to_f/(years*12)*100,(years*12)-spent,((years*12)-spent).to_f/(years*12)*100]
  var summary = '<div>' + size + ' months: ' + now + ' (' + round((now/size*100),0) + '%) lived; ' + (size-now) + ' (' + round((size-now)/size*100,0) + '%) to go!</div>';

  table += summary;
  $('#chart').html(table);
}

jQuery(document).ready(function($) {
  init();
});

</script>
</head>
<body>
<h1>936 Months</h1>
<p>
You can view your life as a series of 936 months assuming a life expectency of 78.  A month sure doesn't seem that long and when viewed as a whole sure don't look like very many.  Generate your own chart and be sure to make every single month count!</p>

<p>
Birthdate (YYYYMM): <input id="birthdate" value="197710">
Life Expectancy: <input id="expect" value="78">
<button id="gobutton" onclick="draw_chart();">Go!</button>
</p>

<div id="chart">
</div>

<p>Inspired by <a href="http://abstrusegoose.com/51">Abstruse Goose #51</a></p>

</body>
</html>
